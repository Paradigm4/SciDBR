lazy array metadata evaluation: set logical plan and schema + derived values as promises
